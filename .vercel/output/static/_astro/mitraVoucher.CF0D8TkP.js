import{j as e}from"./jsx-runtime.CDeAccHH.js";import"./supabaseClient.CUq-Autb.js";import{r as l}from"./index.AGWyUyCC.js";import{S as g,a as b}from"./swiper-react.KqFioOjf.js";import"./index.D2MAbzvX.js";const k=[{id:1,image:"/Irma_voc.webp",title:"Mitra Penjualan Vouvher"},{id:2,image:"/Saroh_voc.webp",title:"Mitra Penjualan Vouvher"},{id:3,image:"/Istiqomah_voc.webp",title:"Mitra Penjualan Vouvher"},{id:4,image:"/Lulu_voc.webp",title:"Mitra Penjualan Vouvher"}],y=a=>e.jsx("div",{className:"w-full max-w-xl",children:e.jsx("img",{src:a.image,alt:a.title,className:"w-full h-auto rounded-xl shadow-md"})},a.id),N=()=>e.jsx("div",{className:"w-full px-4 ",children:e.jsx("div",{className:"w-full",children:e.jsxs(g,{autoplay:{delay:1e3},spaceBetween:-10,slidesPerView:1,breakpoints:{0:{slidesPerView:1,spaceBetween:10},640:{slidesPerView:2,spaceBetween:10},1024:{slidesPerView:2,spaceBetween:30}},children:[k.map(a=>e.jsx(b,{className:"py-4 px-4",children:e.jsx(y,{id:a.id,title:a.title,image:a.image})},a.id)),e.jsxs("h2",{className:"text-dark px-4",children:["Scroll ke Kanan ",">>>>"]})]})})}),P=()=>{const[a,p]=l.useState(null),[n,i]=l.useState(null),[h,x]=l.useState([]),[j,c]=l.useState(null),[f,o]=l.useState(!1),[d,m]=l.useState(!1),w=async t=>{if(t.preventDefault(),a===null||a<=0){i("Masukkan jumlah klien yang valid!");return}try{const s=await fetch("/api/updateclients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({totalClients:a})}),r=await s.json();s.ok?(i("Jumlah klien berhasil diperbarui!"),m(!d),u()):i(r.message||"Gagal memperbarui jumlah klien!")}catch(s){console.error("Unexpected error:",s),i("Terjadi kesalahan, coba lagi nanti.")}},u=async()=>{o(!0);try{const s=await(await fetch("/api/clients")).json();x(s)}catch(t){console.error("Gagal memuat data klien:",t)}finally{o(!1)}};return l.useEffect(()=>{u(),(async()=>{try{const s=await fetch("/api/checksession");if(!s.ok)throw new Error("Session invalid");const r=await s.json();c(r.user)}catch(s){console.error("Failed to fetch user:",s),c(null)}})()},[]),e.jsx("section",{className:"py-16",children:e.jsx("div",{className:"container mx-auto lg:px-32",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"w-full px-4 pb-8 flex flex-col justify-center items-center",children:[e.jsxs("h3",{className:"text-2xl md:text-3xl font-semibold text-center",children:["apmcXdb",e.jsx("span",{className:"text-primary",children:"Net"})," Telah Memiliki"," ",f?e.jsx("p",{children:"..."}):e.jsx(e.Fragment,{children:h.map(t=>e.jsxs("span",{children:[t.total,"+"]},t.id))})," ","Clients untuk saat ini"]}),e.jsxs("h4",{className:"text-base text-slate-600",children:["Berikut adalah beberapa mitra Voucher dari apmcXdb",e.jsx("span",{className:"text-primary",children:"Net"})]}),j&&e.jsx(e.Fragment,{children:d?e.jsxs("form",{action:"",method:"post",onSubmit:w,className:"py-4",children:[e.jsx("input",{type:"number",name:"Update Client",id:"Update Client",value:a||"",onChange:t=>p(parseInt(t.target.value,10)),className:"border p-2 mb-2 w-full",placeholder:"Masukkan jumlah klien",required:!0}),e.jsx("button",{type:"submit",className:"w-full bg-primary text-white p-2 text-center rounded-md",children:"Simpan"}),n&&e.jsx("p",{children:n})]}):e.jsx("button",{onClick:()=>m(!0),className:"px-4 py-2 mt-4 border border-dark/50 rounded-md",children:"Update jumlah Clients"})})]}),e.jsx(N,{})]})})})};export{P as default};
